---
description: Comprehensive pull request review checklist from multiple perspectives
globs: ['**/*.md', '.github/**']
alwaysApply: true
---

# Pull Request Review

## Core Rule

**Rule**: All PRs must be reviewed from multiple perspectives before merge.

**Principle**: Improvements scheduled for "later" must be addressed NOW.

## Review Process

**Steps**:
1. Read PR description and linked issues
2. Review code changes systematically (file by file)
3. Test functionality locally if applicable
4. Consider each perspective below
5. Leave constructive, specific feedback
6. Approve or request changes with clear action items

## Review Perspectives

### 1. Product Manager Review

**Focus**: Business value and user experience.

**Checklist**:
- [ ] Does this deliver promised value?
- [ ] Will users benefit from this change?
- [ ] Does it align with product goals?
- [ ] Are all requirements met?
- [ ] Is the feature complete (no TODOs)?

**Action**: Provide directives for maximum business impact.

**Example Feedback**:
```
‚úÖ Business value is clear - this reduces user onboarding time by 50%.
‚ö†Ô∏è Missing: User feedback collection mechanism mentioned in requirements.
```

### 2. Developer Review

**Focus**: Code quality and maintainability.

**Checklist**:
- [ ] Code follows project conventions (see `code-quality/` rules)
- [ ] SOLID principles applied
- [ ] DRY/KISS principles respected
- [ ] No magic numbers (use named constants)
- [ ] Functions < 50 lines, files < 300 lines
- [ ] Cyclomatic complexity < 10 per function
- [ ] Proper error handling (see `03_error-handling.mdc`)
- [ ] No nested ternaries (max 2 levels)
- [ ] TypeScript strict mode compliance
- [ ] No `any` types without justification

**Action**: Suggest specific code improvements with examples.

**Example Feedback**:
```
‚úÖ Clean separation of concerns.
‚ö†Ô∏è Line 42: Extract magic number 86400 to constant SECONDS_PER_DAY.
‚ö†Ô∏è Function `processOrder` has complexity 12 - consider splitting.
```

**Reference**: `code-quality/01_code-standards.mdc`, `code-quality/04_code-architecture.mdc`

### 3. Quality Engineer Review

**Focus**: Test coverage and edge cases.

**Checklist**:
- [ ] All code paths tested (>80% coverage for critical paths)
- [ ] Edge cases handled
- [ ] Error paths tested
- [ ] Boundary conditions tested (null, empty, max values)
- [ ] Integration tests for API changes
- [ ] No `.skip()` or `.only()` in committed tests
- [ ] Test names are descriptive
- [ ] Regression risk assessed

**Action**: Identify missing tests and scenarios.

**Example Feedback**:
```
‚úÖ Good coverage of happy path.
‚ö†Ô∏è Missing: Test for null user input (line 15).
‚ö†Ô∏è Missing: Test for network timeout scenario.
```

**Reference**: `code-quality/07_code-testing.mdc`

### 4. Security Engineer Review

**Focus**: Security vulnerabilities and data protection.

**Checklist**:
- [ ] Input validation implemented (Zod/Yup schemas)
- [ ] XSS prevention (DOMPurify for user content)
- [ ] SQL injection prevention (parameterized queries)
- [ ] No secrets in code (use environment variables)
- [ ] Authentication/authorization checks present
- [ ] HTTPS used for all network requests
- [ ] CORS configured with strict allowlist
- [ ] Security headers configured

**Action**: Flag security concerns immediately - block merge if critical.

**Example Feedback**:
```
üö® CRITICAL: Line 23 - User input directly concatenated in SQL query.
‚úÖ Good: Input validation with Zod schema.
```

**Reference**: `code-quality/08_security.mdc`

### 5. DevOps Review

**Focus**: CI/CD and deployment readiness.

**Checklist**:
- [ ] CI pipeline passes all checks
- [ ] Build succeeds locally (`pnpm build`)
- [ ] Environment variables documented (`.env.example`)
- [ ] No hardcoded configuration values
- [ ] Database migrations included (if applicable)
- [ ] Rollback plan documented
- [ ] Monitoring/logging added for new features
- [ ] Performance impact assessed

**Action**: Ensure smooth deployment.

**Example Feedback**:
```
‚úÖ CI passes all checks.
‚ö†Ô∏è Missing: Environment variable `API_KEY` not documented in .env.example.
```

### 6. UI/UX Designer Review

**Focus**: Visual consistency and accessibility.

**Checklist**:
- [ ] Matches design system/component library
- [ ] Responsive on mobile/tablet/desktop
- [ ] Accessibility standards met (WCAG 2.1 AA minimum)
- [ ] All form inputs have associated labels
- [ ] Keyboard navigation works
- [ ] Color contrast meets standards
- [ ] Loading states and error messages clear

**Action**: Ensure delightful user experience.

**Example Feedback**:
```
‚úÖ Matches design system.
‚ö†Ô∏è Input on line 45 missing `htmlFor` label association.
‚ö†Ô∏è Color contrast ratio 3.2:1 - needs to be 4.5:1 for AA compliance.
```

## Code Review Checklist

**Reference**: Use this checklist for every code review.

### Code Quality
- [ ] SOLID principles applied
- [ ] DRY / KISS respected
- [ ] No nested ternary expressions (>2 levels)
- [ ] Version consistency across packages
- [ ] Descriptive constants used instead of magic numbers
- [ ] Functions < 50 lines, files < 300 lines
- [ ] Cyclomatic complexity < 10

### Type Safety
- [ ] TypeScript strict mode compliance
- [ ] No `any` types without justification
- [ ] All function parameters and returns typed

### Error Handling
- [ ] All async operations wrapped in try/catch
- [ ] Errors logged with context
- [ ] User-friendly error messages

### Testing
- [ ] Test coverage >80% for critical paths
- [ ] All edge cases tested
- [ ] Error paths tested
- [ ] No `.skip()` or `.only()` in committed code

### Security
- [ ] Input validation implemented
- [ ] No secrets in code
- [ ] XSS/SQL injection prevention
- [ ] HTTPS for all requests

### Documentation
- [ ] Code comments explain "why" not "what"
- [ ] README updated if needed
- [ ] API documentation updated

## Definition of Done

A PR is ready to merge when:
- [ ] All review perspectives addressed
- [ ] All tests pass
- [ ] Code review approved
- [ ] Documentation updated
- [ ] CI pipeline passes
- [ ] No blocking issues

## Review Feedback Format

**Structure**:
```
[Severity] [Location]: [Issue description]

[Why it matters]

[Specific fix suggestion]
```

**Severity Levels**:
- üö® **CRITICAL**: Block merge (security, breaking changes)
- ‚ö†Ô∏è **HIGH**: Should fix before merge (bugs, major issues)
- üí° **MEDIUM**: Nice to have (code quality improvements)
- ‚úÖ **APPROVED**: No issues found

**Example**:
```
‚ö†Ô∏è Line 42: Magic number 86400 used

This makes the code harder to understand and maintain.

Fix: Extract to constant:
const SECONDS_PER_DAY = 86400;
```
